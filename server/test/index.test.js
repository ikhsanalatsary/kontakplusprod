'use strict';

var _mongoose = require('mongoose');

var _mongoose2 = _interopRequireDefault(_mongoose);

var _chai = require('chai');

var _chai2 = _interopRequireDefault(_chai);

var _supertest = require('supertest');

var _supertest2 = _interopRequireDefault(_supertest);

var _btoa = require('btoa');

var _btoa2 = _interopRequireDefault(_btoa);

var _Faker = require('Faker');

var _Faker2 = _interopRequireDefault(_Faker);

var _titlegen = require('titlegen');

var _titlegen2 = _interopRequireDefault(_titlegen);

var _config = require('../config');

var _config2 = _interopRequireDefault(_config);

var _contactsModel = require('../model/contacts.model.js');

var _contactsModel2 = _interopRequireDefault(_contactsModel);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var admin = require('../config/config').admin;
var expect = _chai2.default.expect;

_mongoose2.default.Promise = global.Promise;
_mongoose2.default.connect(_config2.default.getDbConnection());

describe('Routing', function () {
  var url = 'http://localhost:3000';
  var api = 'http://localhost:3000/api/contacts';
  var base64Str = (0, _btoa2.default)(admin.user + ':' + admin.password);
  var config = {
    authorization: {
      "Authorization": 'Basic ' + base64Str,
      "Accept": "application/json"
    },
    unauthorization: {
      "WWW-Authenticate": "Basic realm=Authorization Required"
    }
  };

  var generator = _titlegen2.default.create();
  generator.feed(['My Love', 'Soulmate', 'My Boss', 'My Partner', 'My Teacher', 'My Mentor', 'My Big Brother', 'My Mom', 'My Dad']);

  var gentype = _titlegen2.default.create();
  gentype.feed(['Mobile', 'Work', 'Home']);

  var etype = _titlegen2.default.create();
  etype.feed(['Personal', 'Work', 'Other']);

  var adrtype = _titlegen2.default.create();
  adrtype.feed(['Home', 'Work', 'Other']);

  var contactTitle = generator.next();
  var option = gentype.next();
  var option2 = etype.next();
  var option3 = adrtype.next();
  var contact = {
    name: _Faker2.default.Name.findName(),
    title: contactTitle,
    email: [{ option: option2, email: _Faker2.default.Internet.email() }, { option: option2, email: _Faker2.default.Internet.email() }],
    phone: [{ option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }, { option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }],
    address: [{ option: option3, address: _Faker2.default.Address.streetAddress() }, { option: option3, address: _Faker2.default.Address.streetAddress() }],
    company: _Faker2.default.Company.companyName(),
    favorite: false
  };

  describe("GET '/'", function () {
    it('should get status code 200 with no auth', function (done) {
      (0, _supertest2.default)(url).get('/').set('Accept', 'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8').expect(200, done);
    });
  });

  describe("GET '/api' that not actually route", function () {
    it('should get status 404', function (done) {
      (0, _supertest2.default)(url).get('/api').expect('Content-Type', 'text/html; charset=utf-8').expect(404, done);
    });

    describe("GET '/api/contacts'", function () {
      it('should get status 200 if Authorized and return Array-JSON', function (done) {
        (0, _supertest2.default)(api).get('/').set(config.authorization).expect('Content-Type', /json/).expect(200).end(function (err, res) {
          if (err) return done(err);
          expect(res.body).to.be.instanceof(Array);
          done();
        });
      });
    });

    describe("GET '/api/contacts/:id'", function () {
      it('should get status 200 if Authorized and return Object-json', function (done) {
        var newContact = new _contactsModel2.default(contact);
        var promise = newContact.save();
        promise.then(function (contact) {
          if (contact) {
            (0, _supertest2.default)(api).get('/' + contact.id).set(config.authorization).expect('Content-Type', /json/).expect(200).end(function (err, res) {
              if (err) return done(err);
              expect(res.body).to.be.an('object');
              expect(res.body).to.have.property('name');
              expect(res.body).to.have.property('title');
              expect(res.body).to.have.property('email');
              expect(res.body).to.have.property('phone');
              expect(res.body).to.have.property('address');
              expect(res.body).to.have.property('company');
              expect(res.body).to.have.property('_id').to.equal(contact.id);
              done();
            });
          }
        }).catch(function (err) {
          done(err);
        });
      });
    });
  });

  describe("POST '/api/contacts'", function () {
    it('should post and get response status 200', function (done) {
      var emailVal = [{ option: option2, email: _Faker2.default.Internet.email() }, { option: option2, email: _Faker2.default.Internet.email() }];

      var phoneVal = [{ option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }, { option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }];

      var addVal = [{ option: option3, address: _Faker2.default.Address.streetAddress() }, { option: option3, address: _Faker2.default.Address.streetAddress() }];

      var contact = {
        name: '"' + _Faker2.default.Name.findName() + ' post"',
        title: '"' + contactTitle + '"',
        email: JSON.stringify(emailVal),
        phone: JSON.stringify(phoneVal),
        address: JSON.stringify(phoneVal),
        company: '"' + _Faker2.default.Company.companyName() + '"'
      };

      (0, _supertest2.default)(api).post('/').set(config.authorization).send(contact).expect(200).end(function (err, res) {
        if (err) return done(err);
        expect(res.body).to.be.an('object');
        done();
      });
    });

    describe('upload image', function () {
      it('should get status 200 response', function (done) {
        var emailVal = [{ option: option2, email: _Faker2.default.Internet.email() }, { option: option2, email: _Faker2.default.Internet.email() }];

        var phoneVal = [{ option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }, { option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }];

        var addVal = [{ option: option3, address: _Faker2.default.Address.streetAddress() }, { option: option3, address: _Faker2.default.Address.streetAddress() }];

        (0, _supertest2.default)(api).post('/').set(config.authorization).field('Content-Type', 'multipart/form-data').field('name', JSON.stringify("Tes upload")).field('phone', JSON.stringify(phoneVal)).field('email', JSON.stringify(emailVal)).field('address', JSON.stringify(addVal)).attach('avatar', '/Users/adi/Desktop/Tesphoto.png').end(function (err, res) {
          if (err) return done(err);
          expect(res.status).to.equal(200);
          done();
        });
      });
    });
  });

  describe("PUT '/api/contacts/:id'", function () {
    it('should get status 200 if Authorized', function (done) {
      var emailVal = [{ option: option2, email: _Faker2.default.Internet.email() }, { option: option2, email: _Faker2.default.Internet.email() }];

      var phoneVal = [{ option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }, { option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }];

      var addVal = [{ option: option3, address: _Faker2.default.Address.streetAddress() }, { option: option3, address: _Faker2.default.Address.streetAddress() }];

      var contact = {
        name: '"' + _Faker2.default.Name.findName() + ' post"',
        title: '"' + contactTitle + '"',
        email: JSON.stringify(emailVal),
        phone: JSON.stringify(phoneVal),
        address: JSON.stringify(phoneVal),
        company: '"' + _Faker2.default.Company.companyName() + '"'
      };

      var newContact = new _contactsModel2.default(contact);
      var promise = newContact.save();
      promise.then(function (contact) {
        if (contact) {
          contact.name = JSON.stringify("Jhonny Depp put");
          contact.company = JSON.stringify("Hollywood");
          contact.title = JSON.stringify("Actress");
          (0, _supertest2.default)(api).put('/' + contact.id).set(config.authorization).send(contact).expect('Content-Type', /json/).expect(200).end(function (err, res) {
            if (err) return done(err);
            expect(res.body).to.be.an('object');
            expect(res.body).to.have.property('name').to.equal('Jhonny Depp put');
            expect(res.body).to.have.property('title');
            expect(res.body).to.have.property('email');
            expect(res.body).to.have.property('phone');
            expect(res.body).to.have.property('address');
            expect(res.body).to.have.property('company');
            expect(res.body).to.have.property('_id').to.equal(contact.id);
            done();
          });
        }
      }).catch(function (err) {
        done(err);
      });
    });
  });

  describe("PATCH '/api/contacts/:id'", function () {
    it('should get status 200 if Authorized', function (done) {
      var newContact = new _contactsModel2.default(contact);
      var promise = newContact.save();
      promise.then(function (contact) {
        if (contact) {
          contact.favorite = true;
          contact.name = 'patch';
          (0, _supertest2.default)(api).patch('/' + contact.id).set(config.authorization).send(contact).expect(200).end(function (err, res) {
            if (err) return done(err);
            expect(res.body).to.be.an('object');
            expect(res.body).to.have.property('name').to.equal('patch');
            expect(res.body).to.have.property('favorite').to.equal(true);
            done();
          });
        }
      }).catch(function (err) {
        done(err);
      });
    });
  });

  describe("DELETE '/api/contacts/:id'", function () {
    var emailVal = [{ option: option2, email: _Faker2.default.Internet.email() }, { option: option2, email: _Faker2.default.Internet.email() }];

    var phoneVal = [{ option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }, { option: option, number: _Faker2.default.PhoneNumber.phoneNumber() }];

    var addVal = [{ option: option3, address: _Faker2.default.Address.streetAddress() }, { option: option3, address: _Faker2.default.Address.streetAddress() }];

    var contact = {
      name: '"' + _Faker2.default.Name.findName() + ' post"',
      title: '"' + contactTitle + '"',
      email: JSON.stringify(emailVal),
      phone: JSON.stringify(phoneVal),
      address: JSON.stringify(phoneVal),
      company: '"' + _Faker2.default.Company.companyName() + '"'
    };

    it('should get status 200 if Authorized', function (done) {
      var newContact = new _contactsModel2.default(contact);
      var promise = newContact.save();
      promise.then(function (contact) {
        if (contact) {
          (0, _supertest2.default)(api).delete('/' + contact.id).set(config.authorization).expect(200, done);
        }
      }).catch(function (err) {
        done(err);
      });
    });
  });
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NlcnZlci90ZXN0L2luZGV4LnRlc3QuanMiXSwibmFtZXMiOlsiYWRtaW4iLCJyZXF1aXJlIiwiZXhwZWN0IiwiUHJvbWlzZSIsImdsb2JhbCIsImNvbm5lY3QiLCJnZXREYkNvbm5lY3Rpb24iLCJkZXNjcmliZSIsInVybCIsImFwaSIsImJhc2U2NFN0ciIsInVzZXIiLCJwYXNzd29yZCIsImNvbmZpZyIsImF1dGhvcml6YXRpb24iLCJ1bmF1dGhvcml6YXRpb24iLCJnZW5lcmF0b3IiLCJjcmVhdGUiLCJmZWVkIiwiZ2VudHlwZSIsImV0eXBlIiwiYWRydHlwZSIsImNvbnRhY3RUaXRsZSIsIm5leHQiLCJvcHRpb24iLCJvcHRpb24yIiwib3B0aW9uMyIsImNvbnRhY3QiLCJuYW1lIiwiTmFtZSIsImZpbmROYW1lIiwidGl0bGUiLCJlbWFpbCIsIkludGVybmV0IiwicGhvbmUiLCJudW1iZXIiLCJQaG9uZU51bWJlciIsInBob25lTnVtYmVyIiwiYWRkcmVzcyIsIkFkZHJlc3MiLCJzdHJlZXRBZGRyZXNzIiwiY29tcGFueSIsIkNvbXBhbnkiLCJjb21wYW55TmFtZSIsImZhdm9yaXRlIiwiaXQiLCJkb25lIiwiZ2V0Iiwic2V0IiwiZW5kIiwiZXJyIiwicmVzIiwiYm9keSIsInRvIiwiYmUiLCJpbnN0YW5jZW9mIiwiQXJyYXkiLCJuZXdDb250YWN0IiwicHJvbWlzZSIsInNhdmUiLCJ0aGVuIiwiaWQiLCJhbiIsImhhdmUiLCJwcm9wZXJ0eSIsImVxdWFsIiwiY2F0Y2giLCJlbWFpbFZhbCIsInBob25lVmFsIiwiYWRkVmFsIiwiSlNPTiIsInN0cmluZ2lmeSIsInBvc3QiLCJzZW5kIiwiZmllbGQiLCJhdHRhY2giLCJzdGF0dXMiLCJwdXQiLCJwYXRjaCIsImRlbGV0ZSJdLCJtYXBwaW5ncyI6IkFBQUE7O0FBRUE7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7Ozs7QUFDQTs7Ozs7O0FBQ0Es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QWVELEdBeENEO0FBeUNELENBalZEIiwiZmlsZSI6ImluZGV4LnRlc3QuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmltcG9ydCBtb25nb29zZSBmcm9tICdtb25nb29zZSc7XG5pbXBvcnQgY2hhaSBmcm9tICdjaGFpJztcbmltcG9ydCByZXF1ZXN0IGZyb20gJ3N1cGVydGVzdCc7XG5pbXBvcnQgYnRvYSBmcm9tICdidG9hJztcbmltcG9ydCBmYWtlciBmcm9tICdGYWtlcic7XG5pbXBvcnQgdGl0bGVnZW4gZnJvbSAndGl0bGVnZW4nO1xuaW1wb3J0IGNvbmZpZyBmcm9tICcuLi9jb25maWcnO1xuaW1wb3J0IENvbnRhY3QgZnJvbSAnLi4vbW9kZWwvY29udGFjdHMubW9kZWwuanMnO1xuY29uc3QgYWRtaW4gPSByZXF1aXJlKCcuLi9jb25maWcvY29uZmlnJykuYWRtaW47XG5jb25zdCBleHBlY3QgPSBjaGFpLmV4cGVjdDtcblxubW9uZ29vc2UuUHJvbWlzZSA9IGdsb2JhbC5Qcm9taXNlO1xubW9uZ29vc2UuY29ubmVjdChjb25maWcuZ2V0RGJDb25uZWN0aW9uKCkpO1xuXG5kZXNjcmliZSgnUm91dGluZycsIGZ1bmN0aW9uICgpIHtcbiAgbGV0IHVybCA9ICdodHRwOi8vbG9jYWxob3N0OjMwMDAnO1xuICBsZXQgYXBpID0gJ2h0dHA6Ly9sb2NhbGhvc3Q6MzAwMC9hcGkvY29udGFjdHMnO1xuICBsZXQgYmFzZTY0U3RyID0gYnRvYShgJHthZG1pbi51c2VyfToke2FkbWluLnBhc3N3b3JkfWApO1xuICBsZXQgY29uZmlnID0ge1xuICAgIGF1dGhvcml6YXRpb246IHtcbiAgICAgIFwiQXV0aG9yaXphdGlvblwiOiBgQmFzaWMgJHtiYXNlNjRTdHJ9YCxcbiAgICAgIFwiQWNjZXB0XCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgIH0sXG4gICAgdW5hdXRob3JpemF0aW9uOiB7XG4gICAgICBcIldXVy1BdXRoZW50aWNhdGVcIjogXCJCYXNpYyByZWFsbT1BdXRob3JpemF0aW9uIFJlcXVpcmVkXCIsXG4gICAgfSxcbiAgfTtcblxuICB2YXIgZ2VuZXJhdG9yID0gdGl0bGVnZW4uY3JlYXRlKCk7XG4gIGdlbmVyYXRvci5mZWVkKFtcbiAgICAnTXkgTG92ZScsXG4gICAgJ1NvdWxtYXRlJyxcbiAgICAnTXkgQm9zcycsXG4gICAgJ015IFBhcnRuZXInLFxuICAgICdNeSBUZWFjaGVyJyxcbiAgICAnTXkgTWVudG9yJyxcbiAgICAnTXkgQmlnIEJyb3RoZXInLFxuICAgICdNeSBNb20nLFxuICAgICdNeSBEYWQnLFxuICBdKTtcblxuICB2YXIgZ2VudHlwZSA9IHRpdGxlZ2VuLmNyZWF0ZSgpO1xuICBnZW50eXBlLmZlZWQoW1xuICAgICdNb2JpbGUnLFxuICAgICdXb3JrJyxcbiAgICAnSG9tZScsXG4gIF0pO1xuXG4gIHZhciBldHlwZSA9IHRpdGxlZ2VuLmNyZWF0ZSgpO1xuICBldHlwZS5mZWVkKFtcbiAgICAnUGVyc29uYWwnLFxuICAgICdXb3JrJyxcbiAgICAnT3RoZXInLFxuICBdKTtcblxuICB2YXIgYWRydHlwZSA9IHRpdGxlZ2VuLmNyZWF0ZSgpO1xuICBhZHJ0eXBlLmZlZWQoW1xuICAgICdIb21lJyxcbiAgICAnV29yaycsXG4gICAgJ090aGVyJyxcbiAgXSk7XG5cbiAgdmFyIGNvbnRhY3RUaXRsZSA9IGdlbmVyYXRvci5uZXh0KCk7XG4gIHZhciBvcHRpb24gPSBnZW50eXBlLm5leHQoKTtcbiAgdmFyIG9wdGlvbjIgPSBldHlwZS5uZXh0KCk7XG4gIHZhciBvcHRpb24zID0gYWRydHlwZS5uZXh0KCk7XG4gIHZhciBjb250YWN0ID0ge1xuICAgIG5hbWU6IGZha2VyLk5hbWUuZmluZE5hbWUoKSxcbiAgICB0aXRsZTogY29udGFjdFRpdGxlLFxuICAgIGVtYWlsOiBbXG4gICAgICB7IG9wdGlvbjogb3B0aW9uMiwgZW1haWw6IGZha2VyLkludGVybmV0LmVtYWlsKCkgfSxcbiAgICAgIHsgb3B0aW9uOiBvcHRpb24yLCBlbWFpbDogZmFrZXIuSW50ZXJuZXQuZW1haWwoKSB9LFxuICAgIF0sXG4gICAgcGhvbmU6IFtcbiAgICAgIHsgb3B0aW9uLCBudW1iZXI6IGZha2VyLlBob25lTnVtYmVyLnBob25lTnVtYmVyKCkgfSxcbiAgICAgIHsgb3B0aW9uLCBudW1iZXI6IGZha2VyLlBob25lTnVtYmVyLnBob25lTnVtYmVyKCkgfSxcbiAgICBdLFxuICAgIGFkZHJlc3M6IFtcbiAgICAgIHsgb3B0aW9uOiBvcHRpb24zLCBhZGRyZXNzOiBmYWtlci5BZGRyZXNzLnN0cmVldEFkZHJlc3MoKSB9LFxuICAgICAgeyBvcHRpb246IG9wdGlvbjMsIGFkZHJlc3M6IGZha2VyLkFkZHJlc3Muc3RyZWV0QWRkcmVzcygpIH0sXG4gICAgXSxcbiAgICBjb21wYW55OiBmYWtlci5Db21wYW55LmNvbXBhbnlOYW1lKCksXG4gICAgZmF2b3JpdGU6IGZhbHNlLFxuICB9O1xuXG4gIGRlc2NyaWJlKFwiR0VUICcvJ1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgaXQoJ3Nob3VsZCBnZXQgc3RhdHVzIGNvZGUgMjAwIHdpdGggbm8gYXV0aCcsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICByZXF1ZXN0KHVybClcbiAgICAgICAgLmdldCgnLycpXG4gICAgICAgIC5zZXQoJ0FjY2VwdCcsICd0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLCovKjtxPTAuOCcpXG4gICAgICAgIC5leHBlY3QoMjAwLCBkb25lKTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoXCJHRVQgJy9hcGknIHRoYXQgbm90IGFjdHVhbGx5IHJvdXRlXCIsIGZ1bmN0aW9uICgpIHtcbiAgICBpdCgnc2hvdWxkIGdldCBzdGF0dXMgNDA0JywgZnVuY3Rpb24gKGRvbmUpIHtcbiAgICAgIHJlcXVlc3QodXJsKVxuICAgICAgICAuZ2V0KCcvYXBpJylcbiAgICAgICAgLmV4cGVjdCgnQ29udGVudC1UeXBlJywgJ3RleHQvaHRtbDsgY2hhcnNldD11dGYtOCcpXG4gICAgICAgIC5leHBlY3QoNDA0LCBkb25lKTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKFwiR0VUICcvYXBpL2NvbnRhY3RzJ1wiLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpdCgnc2hvdWxkIGdldCBzdGF0dXMgMjAwIGlmIEF1dGhvcml6ZWQgYW5kIHJldHVybiBBcnJheS1KU09OJywgZnVuY3Rpb24gKGRvbmUpIHtcbiAgICAgICAgcmVxdWVzdChhcGkpXG4gICAgICAgICAgLmdldCgnLycpXG4gICAgICAgICAgLnNldChjb25maWcuYXV0aG9yaXphdGlvbilcbiAgICAgICAgICAuZXhwZWN0KCdDb250ZW50LVR5cGUnLCAvanNvbi8pXG4gICAgICAgICAgLmV4cGVjdCgyMDApXG4gICAgICAgICAgLmVuZCgoZXJyLCByZXMpID0+IHtcbiAgICAgICAgICAgIGlmIChlcnIpIHJldHVybiBkb25lKGVycik7XG4gICAgICAgICAgICBleHBlY3QocmVzLmJvZHkpLnRvLmJlLmluc3RhbmNlb2YoQXJyYXkpO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZShcIkdFVCAnL2FwaS9jb250YWN0cy86aWQnXCIsIGZ1bmN0aW9uICgpIHtcbiAgICAgIGl0KCdzaG91bGQgZ2V0IHN0YXR1cyAyMDAgaWYgQXV0aG9yaXplZCBhbmQgcmV0dXJuIE9iamVjdC1qc29uJywgZnVuY3Rpb24gKGRvbmUpIHtcbiAgICAgICAgbGV0IG5ld0NvbnRhY3QgPSBuZXcgQ29udGFjdChjb250YWN0KTtcbiAgICAgICAgdmFyIHByb21pc2UgPSBuZXdDb250YWN0LnNhdmUoKTtcbiAgICAgICAgcHJvbWlzZS50aGVuKGNvbnRhY3QgPT4ge1xuICAgICAgICAgIGlmIChjb250YWN0KSB7XG4gICAgICAgICAgICByZXF1ZXN0KGFwaSlcbiAgICAgICAgICAgICAgLmdldCgnLycgKyBjb250YWN0LmlkKVxuICAgICAgICAgICAgICAuc2V0KGNvbmZpZy5hdXRob3JpemF0aW9uKVxuICAgICAgICAgICAgICAuZXhwZWN0KCdDb250ZW50LVR5cGUnLCAvanNvbi8pXG4gICAgICAgICAgICAgIC5leHBlY3QoMjAwKVxuICAgICAgICAgICAgICAuZW5kKChlcnIsIHJlcykgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChlcnIpIHJldHVybiBkb25lKGVycik7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5iZS5hbignb2JqZWN0Jyk7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5oYXZlLnByb3BlcnR5KCduYW1lJyk7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5oYXZlLnByb3BlcnR5KCd0aXRsZScpO1xuICAgICAgICAgICAgICAgIGV4cGVjdChyZXMuYm9keSkudG8uaGF2ZS5wcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgICAgICAgICAgICBleHBlY3QocmVzLmJvZHkpLnRvLmhhdmUucHJvcGVydHkoJ3Bob25lJyk7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5oYXZlLnByb3BlcnR5KCdhZGRyZXNzJyk7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5oYXZlLnByb3BlcnR5KCdjb21wYW55Jyk7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5oYXZlLnByb3BlcnR5KCdfaWQnKS50by5lcXVhbChjb250YWN0LmlkKTtcbiAgICAgICAgICAgICAgICBkb25lKCk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgICAgZG9uZShlcnIpO1xuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiUE9TVCAnL2FwaS9jb250YWN0cydcIiwgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgcG9zdCBhbmQgZ2V0IHJlc3BvbnNlIHN0YXR1cyAyMDAnLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgbGV0IGVtYWlsVmFsID0gW1xuICAgICAgICB7IG9wdGlvbjogb3B0aW9uMiwgZW1haWw6IGZha2VyLkludGVybmV0LmVtYWlsKCkgfSxcbiAgICAgICAgeyBvcHRpb246IG9wdGlvbjIsIGVtYWlsOiBmYWtlci5JbnRlcm5ldC5lbWFpbCgpIH0sXG4gICAgICBdO1xuXG4gICAgICBsZXQgcGhvbmVWYWwgPSBbXG4gICAgICAgIHsgb3B0aW9uLCBudW1iZXI6IGZha2VyLlBob25lTnVtYmVyLnBob25lTnVtYmVyKCkgfSxcbiAgICAgICAgeyBvcHRpb24sIG51bWJlcjogZmFrZXIuUGhvbmVOdW1iZXIucGhvbmVOdW1iZXIoKSB9LFxuICAgICAgXTtcblxuICAgICAgbGV0IGFkZFZhbCA9IFtcbiAgICAgICAgeyBvcHRpb246IG9wdGlvbjMsIGFkZHJlc3M6IGZha2VyLkFkZHJlc3Muc3RyZWV0QWRkcmVzcygpIH0sXG4gICAgICAgIHsgb3B0aW9uOiBvcHRpb24zLCBhZGRyZXNzOiBmYWtlci5BZGRyZXNzLnN0cmVldEFkZHJlc3MoKSB9LFxuICAgICAgXTtcblxuICAgICAgbGV0IGNvbnRhY3QgPSB7XG4gICAgICAgIG5hbWU6IGBcIiR7ZmFrZXIuTmFtZS5maW5kTmFtZSgpfSBwb3N0XCJgLFxuICAgICAgICB0aXRsZTogYFwiJHtjb250YWN0VGl0bGV9XCJgLFxuICAgICAgICBlbWFpbDogSlNPTi5zdHJpbmdpZnkoZW1haWxWYWwpLFxuICAgICAgICBwaG9uZTogSlNPTi5zdHJpbmdpZnkocGhvbmVWYWwpLFxuICAgICAgICBhZGRyZXNzOiBKU09OLnN0cmluZ2lmeShwaG9uZVZhbCksXG4gICAgICAgIGNvbXBhbnk6IGBcIiR7ZmFrZXIuQ29tcGFueS5jb21wYW55TmFtZSgpfVwiYCxcbiAgICAgIH07XG5cbiAgICAgIHJlcXVlc3QoYXBpKVxuICAgICAgICAucG9zdCgnLycpXG4gICAgICAgIC5zZXQoY29uZmlnLmF1dGhvcml6YXRpb24pXG4gICAgICAgIC5zZW5kKGNvbnRhY3QpXG4gICAgICAgIC5leHBlY3QoMjAwKVxuICAgICAgICAuZW5kKChlcnIsIHJlcykgPT4ge1xuICAgICAgICAgIGlmIChlcnIpIHJldHVybiBkb25lKGVycik7XG4gICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5iZS5hbignb2JqZWN0Jyk7XG4gICAgICAgICAgZG9uZSgpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCd1cGxvYWQgaW1hZ2UnLCBmdW5jdGlvbiAoKSB7XG4gICAgICBpdCgnc2hvdWxkIGdldCBzdGF0dXMgMjAwIHJlc3BvbnNlJywgZnVuY3Rpb24gKGRvbmUpIHtcbiAgICAgICAgbGV0IGVtYWlsVmFsID0gW1xuICAgICAgICAgIHsgb3B0aW9uOiBvcHRpb24yLCBlbWFpbDogZmFrZXIuSW50ZXJuZXQuZW1haWwoKSB9LFxuICAgICAgICAgIHsgb3B0aW9uOiBvcHRpb24yLCBlbWFpbDogZmFrZXIuSW50ZXJuZXQuZW1haWwoKSB9LFxuICAgICAgICBdO1xuXG4gICAgICAgIGxldCBwaG9uZVZhbCA9IFtcbiAgICAgICAgICB7IG9wdGlvbiwgbnVtYmVyOiBmYWtlci5QaG9uZU51bWJlci5waG9uZU51bWJlcigpIH0sXG4gICAgICAgICAgeyBvcHRpb24sIG51bWJlcjogZmFrZXIuUGhvbmVOdW1iZXIucGhvbmVOdW1iZXIoKSB9LFxuICAgICAgICBdO1xuXG4gICAgICAgIGxldCBhZGRWYWwgPSBbXG4gICAgICAgICAgeyBvcHRpb246IG9wdGlvbjMsIGFkZHJlc3M6IGZha2VyLkFkZHJlc3Muc3RyZWV0QWRkcmVzcygpIH0sXG4gICAgICAgICAgeyBvcHRpb246IG9wdGlvbjMsIGFkZHJlc3M6IGZha2VyLkFkZHJlc3Muc3RyZWV0QWRkcmVzcygpIH0sXG4gICAgICAgIF07XG5cbiAgICAgICAgcmVxdWVzdChhcGkpXG4gICAgICAgICAgLnBvc3QoJy8nKVxuICAgICAgICAgIC5zZXQoY29uZmlnLmF1dGhvcml6YXRpb24pXG4gICAgICAgICAgLmZpZWxkKCdDb250ZW50LVR5cGUnLCAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScpXG4gICAgICAgICAgLmZpZWxkKCduYW1lJywgSlNPTi5zdHJpbmdpZnkoXCJUZXMgdXBsb2FkXCIpKVxuICAgICAgICAgIC5maWVsZCgncGhvbmUnLCBKU09OLnN0cmluZ2lmeShwaG9uZVZhbCkpXG4gICAgICAgICAgLmZpZWxkKCdlbWFpbCcsIEpTT04uc3RyaW5naWZ5KGVtYWlsVmFsKSlcbiAgICAgICAgICAuZmllbGQoJ2FkZHJlc3MnLCBKU09OLnN0cmluZ2lmeShhZGRWYWwpKVxuICAgICAgICAgIC5hdHRhY2goJ2F2YXRhcicsICcvVXNlcnMvYWRpL0Rlc2t0b3AvVGVzcGhvdG8ucG5nJylcbiAgICAgICAgICAuZW5kKChlcnIsIHJlcykgPT4ge1xuICAgICAgICAgICAgaWYgKGVycikgcmV0dXJuIGRvbmUoZXJyKTtcbiAgICAgICAgICAgIGV4cGVjdChyZXMuc3RhdHVzKS50by5lcXVhbCgyMDApO1xuICAgICAgICAgICAgZG9uZSgpO1xuICAgICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH0pO1xuXG4gIGRlc2NyaWJlKFwiUFVUICcvYXBpL2NvbnRhY3RzLzppZCdcIiwgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgZ2V0IHN0YXR1cyAyMDAgaWYgQXV0aG9yaXplZCcsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICBsZXQgZW1haWxWYWwgPSBbXG4gICAgICAgIHsgb3B0aW9uOiBvcHRpb24yLCBlbWFpbDogZmFrZXIuSW50ZXJuZXQuZW1haWwoKSB9LFxuICAgICAgICB7IG9wdGlvbjogb3B0aW9uMiwgZW1haWw6IGZha2VyLkludGVybmV0LmVtYWlsKCkgfSxcbiAgICAgIF07XG5cbiAgICAgIGxldCBwaG9uZVZhbCA9IFtcbiAgICAgICAgeyBvcHRpb24sIG51bWJlcjogZmFrZXIuUGhvbmVOdW1iZXIucGhvbmVOdW1iZXIoKSB9LFxuICAgICAgICB7IG9wdGlvbiwgbnVtYmVyOiBmYWtlci5QaG9uZU51bWJlci5waG9uZU51bWJlcigpIH0sXG4gICAgICBdO1xuXG4gICAgICBsZXQgYWRkVmFsID0gW1xuICAgICAgICB7IG9wdGlvbjogb3B0aW9uMywgYWRkcmVzczogZmFrZXIuQWRkcmVzcy5zdHJlZXRBZGRyZXNzKCkgfSxcbiAgICAgICAgeyBvcHRpb246IG9wdGlvbjMsIGFkZHJlc3M6IGZha2VyLkFkZHJlc3Muc3RyZWV0QWRkcmVzcygpIH0sXG4gICAgICBdO1xuXG4gICAgICBsZXQgY29udGFjdCA9IHtcbiAgICAgICAgbmFtZTogYFwiJHtmYWtlci5OYW1lLmZpbmROYW1lKCl9IHBvc3RcImAsXG4gICAgICAgIHRpdGxlOiBgXCIke2NvbnRhY3RUaXRsZX1cImAsXG4gICAgICAgIGVtYWlsOiBKU09OLnN0cmluZ2lmeShlbWFpbFZhbCksXG4gICAgICAgIHBob25lOiBKU09OLnN0cmluZ2lmeShwaG9uZVZhbCksXG4gICAgICAgIGFkZHJlc3M6IEpTT04uc3RyaW5naWZ5KHBob25lVmFsKSxcbiAgICAgICAgY29tcGFueTogYFwiJHtmYWtlci5Db21wYW55LmNvbXBhbnlOYW1lKCl9XCJgLFxuICAgICAgfTtcblxuICAgICAgbGV0IG5ld0NvbnRhY3QgPSBuZXcgQ29udGFjdChjb250YWN0KTtcbiAgICAgIHZhciBwcm9taXNlID0gbmV3Q29udGFjdC5zYXZlKCk7XG4gICAgICBwcm9taXNlLnRoZW4oY29udGFjdCA9PiB7XG4gICAgICAgIGlmIChjb250YWN0KSB7XG4gICAgICAgICAgY29udGFjdC5uYW1lID0gSlNPTi5zdHJpbmdpZnkoXCJKaG9ubnkgRGVwcCBwdXRcIik7XG4gICAgICAgICAgY29udGFjdC5jb21wYW55ID0gSlNPTi5zdHJpbmdpZnkoXCJIb2xseXdvb2RcIik7XG4gICAgICAgICAgY29udGFjdC50aXRsZSA9IEpTT04uc3RyaW5naWZ5KFwiQWN0cmVzc1wiKTtcbiAgICAgICAgICByZXF1ZXN0KGFwaSlcbiAgICAgICAgICAgIC5wdXQoJy8nICsgY29udGFjdC5pZClcbiAgICAgICAgICAgIC5zZXQoY29uZmlnLmF1dGhvcml6YXRpb24pXG4gICAgICAgICAgICAuc2VuZChjb250YWN0KVxuICAgICAgICAgICAgLmV4cGVjdCgnQ29udGVudC1UeXBlJywgL2pzb24vKVxuICAgICAgICAgICAgLmV4cGVjdCgyMDApXG4gICAgICAgICAgICAuZW5kKChlcnIsIHJlcykgPT4ge1xuICAgICAgICAgICAgICBpZiAoZXJyKSByZXR1cm4gZG9uZShlcnIpO1xuICAgICAgICAgICAgICBleHBlY3QocmVzLmJvZHkpLnRvLmJlLmFuKCdvYmplY3QnKTtcbiAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5oYXZlLnByb3BlcnR5KCduYW1lJykudG8uZXF1YWwoJ0pob25ueSBEZXBwIHB1dCcpO1xuICAgICAgICAgICAgICBleHBlY3QocmVzLmJvZHkpLnRvLmhhdmUucHJvcGVydHkoJ3RpdGxlJyk7XG4gICAgICAgICAgICAgIGV4cGVjdChyZXMuYm9keSkudG8uaGF2ZS5wcm9wZXJ0eSgnZW1haWwnKTtcbiAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5oYXZlLnByb3BlcnR5KCdwaG9uZScpO1xuICAgICAgICAgICAgICBleHBlY3QocmVzLmJvZHkpLnRvLmhhdmUucHJvcGVydHkoJ2FkZHJlc3MnKTtcbiAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5oYXZlLnByb3BlcnR5KCdjb21wYW55Jyk7XG4gICAgICAgICAgICAgIGV4cGVjdChyZXMuYm9keSkudG8uaGF2ZS5wcm9wZXJ0eSgnX2lkJykudG8uZXF1YWwoY29udGFjdC5pZCk7XG4gICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGRvbmUoZXJyKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIlBBVENIICcvYXBpL2NvbnRhY3RzLzppZCdcIiwgZnVuY3Rpb24gKCkge1xuICAgIGl0KCdzaG91bGQgZ2V0IHN0YXR1cyAyMDAgaWYgQXV0aG9yaXplZCcsIGZ1bmN0aW9uIChkb25lKSB7XG4gICAgICBsZXQgbmV3Q29udGFjdCA9IG5ldyBDb250YWN0KGNvbnRhY3QpO1xuICAgICAgdmFyIHByb21pc2UgPSBuZXdDb250YWN0LnNhdmUoKTtcbiAgICAgIHByb21pc2UudGhlbihjb250YWN0ID0+IHtcbiAgICAgICAgaWYgKGNvbnRhY3QpIHtcbiAgICAgICAgICBjb250YWN0LmZhdm9yaXRlID0gdHJ1ZTtcbiAgICAgICAgICBjb250YWN0Lm5hbWUgPSAncGF0Y2gnO1xuICAgICAgICAgIHJlcXVlc3QoYXBpKVxuICAgICAgICAgICAgLnBhdGNoKCcvJyArIGNvbnRhY3QuaWQpXG4gICAgICAgICAgICAuc2V0KGNvbmZpZy5hdXRob3JpemF0aW9uKVxuICAgICAgICAgICAgLnNlbmQoY29udGFjdClcbiAgICAgICAgICAgIC5leHBlY3QoMjAwKVxuICAgICAgICAgICAgLmVuZCgoZXJyLCByZXMpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGVycikgcmV0dXJuIGRvbmUoZXJyKTtcbiAgICAgICAgICAgICAgZXhwZWN0KHJlcy5ib2R5KS50by5iZS5hbignb2JqZWN0Jyk7XG4gICAgICAgICAgICAgIGV4cGVjdChyZXMuYm9keSkudG8uaGF2ZS5wcm9wZXJ0eSgnbmFtZScpLnRvLmVxdWFsKCdwYXRjaCcpO1xuICAgICAgICAgICAgICBleHBlY3QocmVzLmJvZHkpLnRvLmhhdmUucHJvcGVydHkoJ2Zhdm9yaXRlJykudG8uZXF1YWwodHJ1ZSk7XG4gICAgICAgICAgICAgIGRvbmUoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGRvbmUoZXJyKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcblxuICBkZXNjcmliZShcIkRFTEVURSAnL2FwaS9jb250YWN0cy86aWQnXCIsIGZ1bmN0aW9uICgpIHtcbiAgICBsZXQgZW1haWxWYWwgPSBbXG4gICAgICB7IG9wdGlvbjogb3B0aW9uMiwgZW1haWw6IGZha2VyLkludGVybmV0LmVtYWlsKCkgfSxcbiAgICAgIHsgb3B0aW9uOiBvcHRpb24yLCBlbWFpbDogZmFrZXIuSW50ZXJuZXQuZW1haWwoKSB9LFxuICAgIF07XG5cbiAgICBsZXQgcGhvbmVWYWwgPSBbXG4gICAgICB7IG9wdGlvbiwgbnVtYmVyOiBmYWtlci5QaG9uZU51bWJlci5waG9uZU51bWJlcigpIH0sXG4gICAgICB7IG9wdGlvbiwgbnVtYmVyOiBmYWtlci5QaG9uZU51bWJlci5waG9uZU51bWJlcigpIH0sXG4gICAgXTtcblxuICAgIGxldCBhZGRWYWwgPSBbXG4gICAgICB7IG9wdGlvbjogb3B0aW9uMywgYWRkcmVzczogZmFrZXIuQWRkcmVzcy5zdHJlZXRBZGRyZXNzKCkgfSxcbiAgICAgIHsgb3B0aW9uOiBvcHRpb24zLCBhZGRyZXNzOiBmYWtlci5BZGRyZXNzLnN0cmVldEFkZHJlc3MoKSB9LFxuICAgIF07XG5cbiAgICBsZXQgY29udGFjdCA9IHtcbiAgICAgIG5hbWU6IGBcIiR7ZmFrZXIuTmFtZS5maW5kTmFtZSgpfSBwb3N0XCJgLFxuICAgICAgdGl0bGU6IGBcIiR7Y29udGFjdFRpdGxlfVwiYCxcbiAgICAgIGVtYWlsOiBKU09OLnN0cmluZ2lmeShlbWFpbFZhbCksXG4gICAgICBwaG9uZTogSlNPTi5zdHJpbmdpZnkocGhvbmVWYWwpLFxuICAgICAgYWRkcmVzczogSlNPTi5zdHJpbmdpZnkocGhvbmVWYWwpLFxuICAgICAgY29tcGFueTogYFwiJHtmYWtlci5Db21wYW55LmNvbXBhbnlOYW1lKCl9XCJgLFxuICAgIH07XG5cbiAgICBpdCgnc2hvdWxkIGdldCBzdGF0dXMgMjAwIGlmIEF1dGhvcml6ZWQnLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgbGV0IG5ld0NvbnRhY3QgPSBuZXcgQ29udGFjdChjb250YWN0KTtcbiAgICAgIHZhciBwcm9taXNlID0gbmV3Q29udGFjdC5zYXZlKCk7XG4gICAgICBwcm9taXNlLnRoZW4oY29udGFjdCA9PiB7XG4gICAgICAgIGlmIChjb250YWN0KSB7XG4gICAgICAgICAgcmVxdWVzdChhcGkpXG4gICAgICAgICAgICAuZGVsZXRlKCcvJyArIGNvbnRhY3QuaWQpXG4gICAgICAgICAgICAuc2V0KGNvbmZpZy5hdXRob3JpemF0aW9uKVxuICAgICAgICAgICAgLmV4cGVjdCgyMDAsIGRvbmUpO1xuICAgICAgICB9XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGVyciA9PiB7XG4gICAgICAgIGRvbmUoZXJyKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9KTtcbn0pO1xuIl19